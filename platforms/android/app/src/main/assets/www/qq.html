<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
    <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>
<style>
   
        .bg {
            background: #c9f3f8d2;
            background-repeat: no-repeat;
            background-attachment: scroll;
            overflow: scroll;
        }
    
        .bg1 {
            background-color: white;
            border-radius: 30px;
            display: block;
            margin: 15px;
            height: 615px;
    
        }
    
        .div {
            text-indent: 3px;
            width: 350px;
            height: 75px;
            font-size: 29px;
            font-weight: bold;
        }
    
        .quick {
            float: left;
            width: 90px;
            height: 90px;
            margin: 20px;
        } 
    
        .clearfix {
            width: 100px;
            margin: 0 auto;
            overflow: hidden;
            }
        
    
        .img {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 95px;
            height: 95px;
    
        }
    
        * {
            padding: auto;
            margin: auto;
            text-align: center;
        }
    
       
        .text1 {
            text-indent: 2px;
            text-align: center;
            width: 350px;
            height: 75px;
            font-size: 75px;
            color:  #12c3d6f6;
            font-weight: bold;
        }
    
        .quick {
            float: left;
            width: 95px;
            height: 95px;
            margin: 5px;
        }
    
        .quick1 {
            float: left;
            width: 25px;
            height: 25px;
            margin: 15px;
        }
    
        .clearfix {
            overflow: auto;
        }
    
        .img {
            width: 25px;
            height: 25px;
    
        }
    </style>

<body>

    <ons-page>
        <ons-toolbar style="background: #00bcd5;">

            <div class="left">
                <ons-icon size="45px" onclick="confirm()" icon="angle-left">
                </ons-icon>
            </div>
        </ons-toolbar>
        <ons-page>
             <div class="bg">
                <div class="bg1">
                    <div class="row">
                        <!-- <img class="quick" src="img/tooth12.png" > -->
                        <div class="div">
                            <img class="quick" src="img/tooth.png" ><br>TIEN DENTAL</div>

                    </div>
                    <br>
                    <br>

                    <div class="text1" id="order"></div> <br><br><br>

                    <ons-row>
                        <ons-col>
                            <div class="clearfix">
                                <img class="quick1" src="img/tooth7.png"> <br>
                                <div style="color:black" id="date"></div>
                            </div>
                        </ons-col>


                        <ons-col>
                            <div class="clearfix" style="margin-left:50px">
                                <img class="quick1" src="img/medical.png"> <br>
                                <div style="color: black" id="time"></div>
                            </div>
                        </ons-col>
                    </ons-row>

                    <p style="text-align: center; margin-top: 10px; color: RGB(0, 0, 0, 0.8); font-size: 18px">

                        เหลืออีก</p>
                    <br>
                    <div class="progress-bar progress-bar--material progress-bar--indeterminate">
                    </div>
                    <br><br>
                    <div id="numQ" style="text-indent: 15px; text-align: center; font-size: 90px;color: RGB(0, 0, 0, 0.6);
                            font-weight: bold;"></div>
                    <br><br>
                    <br>
                    <div style="border-bottom:#999999 1.5px dotted;"></div><br>

                   
                    <ons-button style="background: #00bcd5;"  modifier="large" onclick="createAlertDialog()">ยกเลิกคิว</ons-button>

                </div>


            </div>

            <script>
                var date = localStorage.getItem("date"); //เก็บวันที่
                var time = localStorage.getItem("time"); //เก็บเวลา


                console.log("Date::" + date);
                console.log("time::" + time);


                document.getElementById("date").innerHTML = date; //แสดงวันที่
                document.getElementById("time").innerHTML = time; //แสดงเวลา

                var arrOrderMF = ["A001", "A002", "A003", "A004", "A005"];
                var arrOrderSS = ["A001", "A002", "A003", "A004", "A005",
                    "A006", "A007", "A008", "A009", "A010"];

                var day = localStorage.getItem("day")
                if (day == "Sun" || day == "Sat") {
                    console.log(arrOrderSS);
                    var timeSS1;
                    var timeSS2;
                    var numQ;
                    var time2 = localStorage.getItem("time");
                    switch (time2) {
                        case time2 = "9:00-9:45":
                            timeSS2 = "A001";
                            numQ = "คิวแรก";
                            break;
                        case time2 = "9:45-10:30":

                            timeSS2 = "A002";
                            numQ = "1 คิว";
                            break;
                        case time2 = "10:30-11:15":

                            timeSS2 = "A003";
                            numQ = "2 คิว";
                            break;
                        case time2 = "11:15-12:00":

                            timeSS2 = "A004";
                            numQ = "3 คิว";
                            break;
                        case time2 = "13:00-13:45":

                            timeSS2 = "A005";
                            numQ = "4 คิว";
                            break;
                        case time2 = "13:45-14:30":

                            timeSS2 = "A006";
                            numQ = "5 คิว";
                            break;
                        case time2 = "14:30-15:15":

                            timeSS2 = "A007";
                            numQ = "6 คิว";
                            break;
                        case time2 = "15:15-16:00":

                            timeSS2 = "A008";
                            numQ = "7 คิว";
                            break;
                        case time2 = "16:00-16:45":

                            timeSS2 = "A009";
                            numQ = "8 คิว";
                            break;
                        case time2 = "16:45-17:30":

                            timeSS2 = "A010";
                            numQ = "9 คิว";

                    }

                    document.getElementById("order").innerHTML = timeSS2;
                    document.getElementById("numQ").innerHTML = numQ;

                } else {
                    console.log(arrOrderMF);
                    var timeSS1;
                    var timeSS2;
                    var numQ;
                    var time2 = localStorage.getItem("time");
                    switch (time2) {
                        case time2 = "17:00-17:45":
                            timeSS2 = "A001";
                            numQ = "คิวแรก";
                            break;
                        case time2 = "17:45-18:30":

                            timeSS2 = "A002";
                            numQ = "1 คิว";
                            break;
                        case time2 = "18:30-19:15":

                            timeSS2 = "A003";
                            numQ = "2 คิว";
                            break;
                        case time2 = "19:15-20:00":
                            timeSS2 = "A004";
                            numQ = "3 คิว";
                            break;
                        case time2 = "20:00-20:45":
                            timeSS2 = "A005";
                            numQ = "4 คิว";


                    }
                }

                document.getElementById("order").innerHTML = timeSS2;
                document.getElementById("numQ").innerHTML = numQ;

                var index = localStorage.getItem("Index");
               
                var settings = {
                    "async": true,
                    "crossDomain": true,
                    "url": "http://172.26.252.97:8080/book",
                    "method": "GET",
                    "headers": {
                        "Content-Type": "application/x-www-form-urlencoded",
                        "cache-control": "no-cache",
                        "Postman-Token": "245e85de-d347-4c15-9061-ffe63ea8c51c"
                    }
                }

                $.ajax(settings).done(function (response) {
                    console.log(response);
                    let loop = response.data;
                    
                   
                    for (let j = 0; j < loop.length; j++) {

                        if (index == loop[j].CusID && time == loop[j].Time && date == loop[j].start) {
                            console.log(" LoopBook123: " + loop[j].BookID);
                            localStorage.setItem('bookID',loop[j].BookID);
                          
                        }
                    }

                });
        function cencelbook() {
            localStorage.setItem('showq',0);
           var bookid = localStorage.getItem("bookID");
            var settings = {
                "async": true,
                "crossDomain": true,
                "url": "http://172.26.252.97:8080/book/" + bookid,
                "method": "DELETE",
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "cache-control": "no-cache",
                    "Postman-Token": "21e3580e-c748-47b9-9ef8-e092352e4d76"
                }
            }

            $.ajax(settings).done(function (response) {
                console.log(response);
            });
            gotohome();
        }

function gotohome() {

        window.location.href = 'home.html'
    }
            </script>
<template id="alert-dialog.html">
 <ons-alert-dialog id="my-alert-dialog" modifier="rowfooter">
        <div class="clearfix" style="margin-left: 100px">
                    <img src="img/crying.png" style="width: 60px; height: 60px;"> <br>
                </div>
        <div class="alert-dialog-content">
         คุณต้องการยกเลิกคิวใช่ไหม ? 

        </div>
        <div class="alert-dialog-footer">
          <ons-alert-dialog-button style="color:blue" onclick="hideAlertDialog()">ปิด</ons-alert-dialog-button>
          <ons-alert-dialog-button style="color:red" onclick="cencelbook()">ยืนยันการยกเลิก</ons-alert-dialog-button>
        </div>
      </ons-alert-dialog>
    </template>
        </ons-page>






</body>



<script>
var createAlertDialog = function() {
  var dialog = document.getElementById('my-alert-dialog');

  if (dialog) {
    dialog.show();
  } else {
    ons.createElement('alert-dialog.html', { append: true })
      .then(function(dialog) {
        dialog.show();
      });
  }
};

var hideAlertDialog = function() {
  document
    .getElementById('my-alert-dialog')
    .hide();
};


    function confirm() {
        window.location.href = 'home.html'
    }
    // function cancle() {
    //     window.location.href = 'cancle.html'
    // }
</script>

</html>